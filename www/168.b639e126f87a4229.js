"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[168],{168:(C,P,i)=>{i.r(P),i.d(P,{LoginPageModule:()=>h});var f=i(1368),t=i(4716),o=i(2112),y=i(2508),d=i(1528),e=i(4496),_=i(4256);const r=()=>["/register"],l=[{path:"",component:(()=>{var n;class c{constructor(s,a,v){this.userService=s,this.router=a,this.alertController=v,this.user={companyName:"",password:""}}ngOnInit(){}loginUser(){var s=this;return(0,d.c)(function*(){return s.user.companyName&&s.user.password?(s.userService.loginUser(s.user).then(a=>a?(s.router.navigate(["/home"]),!0):(s.presentAlert("Error","User does not exist or password is incorrect"),!1)),!1):(yield s.presentAlert("Error","Please fill all required fields"),!1)})()}presentAlert(s,a){var v=this;return(0,d.c)(function*(){yield(yield v.alertController.create({header:s,message:a,buttons:["OK"]})).present()})()}}return(n=c).\u0275fac=function(s){return new(s||n)(e.GI1(_.u),e.GI1(y.E5),e.GI1(o.iW))},n.\u0275cmp=e.In1({type:n,selectors:[["app-login"]],decls:28,vars:4,consts:[["color","primary-contrast",1,"center_toolbar"],["src","/assets/global/BizSwapLogo.png",1,"ion-text-center","ion-margin","ion-padding"],[1,"ion-text-center","white-text"],[1,"white-text"],[1,"ion-text-start","white-text"],["color","dark",1,"ion-border-radius"],["type","email","required","",1,"",3,"ngModel","ngModelChange"],["type","password","required","",3,"ngModel","ngModelChange"],["expand","block","color","orange",1,"ion-margin",3,"click"],[1,"ion-text-center"],["color","yellow","fill","clear",3,"routerLink"],[1,""]],template:function(s,a){1&s&&(e.I0R(0,"ion-header"),e.wR5(1,"ion-toolbar",0),e.C$Y(),e.I0R(2,"ion-content"),e.wR5(3,"ion-img",1)(4,"br"),e.I0R(5,"ion-card")(6,"ion-card-header",2)(7,"ion-card-title",3),e.OEk(8,"Login"),e.C$Y()(),e.I0R(9,"ion-card-content")(10,"ion-label",4),e.OEk(11,"Username"),e.C$Y(),e.I0R(12,"ion-item",5)(13,"ion-input",6),e.iHE("ngModelChange",function(p){return e.kNx(a.user.companyName,p)||(a.user.companyName=p),p}),e.C$Y()(),e.wR5(14,"br"),e.I0R(15,"ion-label",4),e.OEk(16,"Password"),e.C$Y(),e.I0R(17,"ion-item",5)(18,"ion-input",7),e.iHE("ngModelChange",function(p){return e.kNx(a.user.password,p)||(a.user.password=p),p}),e.C$Y()()(),e.I0R(19,"ion-button",8),e.qCj("click",function(){return a.loginUser()}),e.I0R(20,"ion-label",3),e.OEk(21,"Login"),e.C$Y()()(),e.I0R(22,"ion-grid")(23,"ion-row")(24,"ion-col",9)(25,"ion-button",10)(26,"ion-label",11),e.OEk(27,"Register"),e.C$Y()()()()()()),2&s&&(e.yG2(13),e.OKB("ngModel",a.user.companyName),e.yG2(5),e.OKB("ngModel",a.user.password),e.yG2(7),e.E7m("routerLink",e.q4q(3,r)))},dependencies:[t.ue,t.eJ,t._G,o.sn,o.KC,o.Gg,o.YY,o.I7,o.Kk,o._i,o.YP,o.wB,o.Eh,o.A5,o.Yb,o.QR,o.qo,o.Md,o.qG,o.mY,y.ER],styles:[".custom-content[_ngcontent-%COMP%], .center_tool[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.login[_ngcontent-%COMP%]{width:15em}.white-text[_ngcontent-%COMP%]{color:#fff!important}"]}),c})()}];let g=(()=>{var n;class c{}return(n=c).\u0275fac=function(s){return new(s||n)},n.\u0275mod=e.a4G({type:n}),n.\u0275inj=e.s3X({imports:[y.qQ.forChild(l),y.qQ]}),c})(),h=(()=>{var n;class c{}return(n=c).\u0275fac=function(s){return new(s||n)},n.\u0275mod=e.a4G({type:n}),n.\u0275inj=e.s3X({imports:[f.MD,t.y,o.wZ,g]}),c})()},4256:(C,P,i)=>{i.d(P,{u:()=>y});var f=i(1528),t=i(8754),o=i(4496);let y=(()=>{var d;class e{constructor(r){this.firestore=r}createUser(r){var u=this;return(0,f.c)(function*(){return u.verifyIfUserExists(r).then(function(){var l=(0,f.c)(function*(g){if(g)return Promise.resolve(!1);let c="users/"+r.companyName;try{return yield(0,t.Sm)((0,t.UN)(u.firestore,c),r),localStorage.setItem("currentUser",JSON.stringify(r)),Promise.resolve(!0)}catch{return Promise.resolve(!1)}});return function(g){return l.apply(this,arguments)}}())})()}verifyIfUserExists(r){var u=this;return(0,f.c)(function*(){try{const l=(0,t.kt)((0,t.oV)(u.firestore,"users"),(0,t.A9)("companyName","==",r.companyName)),g=yield(0,t.uY)(l);return Promise.resolve(!g.empty)}catch{return Promise.resolve(!1)}})()}loginUser(r){var u=this;return(0,f.c)(function*(){try{const l=(0,t.kt)((0,t.oV)(u.firestore,"users"),(0,t.A9)("companyName","==",r.companyName),(0,t.A9)("password","==",r.password));if((yield(0,t.uY)(l)).empty)return Promise.resolve(!1);{let c="users/"+r.companyName;return r=(yield(0,t.i4)((0,t.UN)(u.firestore,c))).data(),localStorage.setItem("currentUser",JSON.stringify(r)),console.log("User logged in",u.getCurrentUser()),Promise.resolve(!0)}}catch{return Promise.resolve(!1)}})()}getCurrentUser(){const r=localStorage.getItem("currentUser");return r?JSON.parse(r):null}clearCurrentUser(){localStorage.removeItem("currentUser")}updateUser(r){var u=this;return(0,f.c)(function*(){const g=r.companyName;try{const n=(0,t.UN)(u.firestore,"users",g);return yield(0,t.gD)(n,{companyName:r.companyName,email:r.email,password:r.password,isCompany:r.isCompany}),console.log("User updated successfully:",r),!0}catch(n){return console.error("Error updating user:",n),!1}})()}}return(d=e).\u0275fac=function(r){return new(r||d)(o.CoB(t.OI))},d.\u0275prov=o.wxM({token:d,factory:d.\u0275fac,providedIn:"root"}),e})()}}]);